<Window x:Class="ollamidesk.RAG.Windows.RagSettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="RAG Configuration" Height="400" Width="500"
        WindowStartupLocation="CenterOwner">
	<Grid Margin="20">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<TextBlock Text="RAG Configuration" FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>

		<ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
			<StackPanel>

				<GroupBox Header="Retrieval Parameters" Margin="0,0,0,10">
					<Grid Margin="10">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto" MinWidth="100"/>
							<ColumnDefinition Width="*"/>
							<ColumnDefinition Width="Auto"/>
						</Grid.ColumnDefinitions>
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="Auto"/>
						</Grid.RowDefinitions>

						<TextBlock Text="Max Chunks:" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,5,0"/>
						<Slider Grid.Row="0" Grid.Column="1" Minimum="1" Maximum="20" Value="{Binding MaxRetrievedChunks}"
                                TickFrequency="1" IsSnapToTickEnabled="True" TickPlacement="BottomRight" Margin="5,0"/>
						<TextBox Grid.Row="0" Grid.Column="2" Width="60" Text="{Binding MaxRetrievedChunks}"/>

						<TextBlock Text="Min Similarity:" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="0,5,5,0"/>
						<Slider Grid.Row="1" Grid.Column="1" Minimum="0" Maximum="1" Value="{Binding MinSimilarityScore}"
                                TickFrequency="0.05" TickPlacement="BottomRight" Margin="5,5,5,0"/>
						<TextBox Grid.Row="1" Grid.Column="2" Width="60" Text="{Binding MinSimilarityScore, StringFormat=N2}" Margin="0,5,0,0"/>
					</Grid>
				</GroupBox>

				<GroupBox Header="Chunking Parameters" Margin="0,0,0,10">
					<Grid Margin="10">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto" MinWidth="100"/>
							<ColumnDefinition Width="*"/>
							<ColumnDefinition Width="Auto"/>
						</Grid.ColumnDefinitions>
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="Auto"/>
						</Grid.RowDefinitions>

						<TextBlock Text="Chunk Size:" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,5,0"/>
						<Slider Grid.Row="0" Grid.Column="1" Minimum="100" Maximum="2000" Value="{Binding ChunkSize}"
                                TickFrequency="100" IsSnapToTickEnabled="True" TickPlacement="BottomRight" Margin="5,0"/>
						<TextBox Grid.Row="0" Grid.Column="2" Width="60" Text="{Binding ChunkSize}"/>

						<TextBlock Text="Chunk Overlap:" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="0,5,5,0"/>
						<Slider Grid.Row="1" Grid.Column="1" Minimum="0" Maximum="500" Value="{Binding ChunkOverlap}"
                                TickFrequency="25" IsSnapToTickEnabled="True" TickPlacement="BottomRight" Margin="5,5,5,0"/>
						<TextBox Grid.Row="1" Grid.Column="2" Width="60" Text="{Binding ChunkOverlap}" Margin="0,5,0,0"/>
					</Grid>
				</GroupBox>

				<GroupBox Header="Advanced Parameters" Margin="0,0,0,10">
					<Grid Margin="10">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto" MinWidth="100"/>
							<ColumnDefinition Width="*"/>
						</Grid.ColumnDefinitions>
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
						</Grid.RowDefinitions>

						<TextBlock Text="Semantic Chunking:" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,5,0"/>
						<CheckBox Grid.Row="0" Grid.Column="1" IsChecked="{Binding UseSemanticChunking}" VerticalAlignment="Center"/>
					</Grid>
				</GroupBox>

				<TextBlock TextWrapping="Wrap" Margin="0,10" FontStyle="Italic" Foreground="Gray">
					Note: Changes to these settings will affect future document processing but won't
					automatically reprocess existing documents. You may need to delete and re-add documents
					for changes to Chunking or Semantic Chunking to apply.
				</TextBlock>
			</StackPanel>
		</ScrollViewer>

		<StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
			<Button Content="Reset Defaults" Command="{Binding ResetCommand}" Padding="10,5" Margin="0,0,10,0" MinWidth="100"/>
			<Button Content="Save" Command="{Binding SaveCommand}" IsDefault="True" Padding="20,5" Margin="0,0,10,0" MinWidth="80"/>
			<Button Content="Cancel" Command="{Binding CancelCommand}" IsCancel="True" Padding="10,5" MinWidth="80"/>
		</StackPanel>
	</Grid>
</Window>